# ENTRY_V10.1_SNIPER Policy Configuration (FLAT THRESHOLD 0.14) - LOWZONE sweep
#
# SNIPER entry policy with ENTRY_V10.1 HYBRID (XGB + Transformer).
# FLAT mode: No aggressive sizing, uses baseline sizing from P4.1.
# THRESHOLD 0.14: LOWZONE threshold sweep test value.
#
# Configuration:
#   - Entry: ENTRY_V10.1 HYBRID (variant=v10_1, seq_len=90)
#   - Same regime blocks as P4.1 (TREND_UP×LOW, NEUTRAL×HIGH, DOWN×HIGH)
#   - Same session filters (EU/OVERLAP/US)
#   - Baseline sizing (same lot/risk logic as P4.1)
#   - Threshold: min_prob_long=0.14, p_side_min.long=0.14
#
# Status: OFFLINE_ONLY (LOWZONE threshold sweep test)

entry_v9_policy_sniper:
  enabled: true
  min_prob_long: 0.14  # LOWZONE threshold sweep test value
  min_prob_profitable: 0.0
  enable_profitable_filter: false
  require_trend_up: false
  
  allow_low_vol: true
  allow_medium_vol: true
  allow_high_vol: true
  allow_extreme_vol: false
  
  allow_short: false

entry_models:
  v9:
    enabled: false
  
  v10:
    enabled: true
    variant: v10_1
    model_path: "models/entry_v10/entry_v10_1_transformer.pt"
    meta_path: "models/entry_v10/entry_v10_1_transformer_meta.json"
    feature_meta_path: "gx1/models/entry_v9/nextgen_2020_2025_clean/entry_v9_feature_meta.json"
  
  xgb:
    enabled: true
    eu_model_path: "models/entry_v10/xgb_entry_EU_v10.joblib"
    us_model_path: "models/entry_v10/xgb_entry_US_v10.joblib"
    overlap_model_path: "models/entry_v10/xgb_entry_OVERLAP_v10.joblib"

require_v9_for_entry: false

meta_model:
  enabled: true
  model_path: gx1/models/farm_entry_meta/baseline_model.pkl
  feature_cols_path: gx1/models/farm_entry_meta/feature_cols.json

allowed_sessions: ["EU", "OVERLAP", "US"]
allowed_vol_regimes: ["LOW", "MEDIUM", "HIGH"]
allowed_trend_regimes: []

guard:
  enabled: true

entry_gating:
  p_side_min:
    long: 0.14  # LOWZONE threshold sweep test value
    short: 1.0
  margin_min:
    long: 0.50
    short: 0.50
  side_ratio_min: 1.25
  sticky_bars: 1
  
  stage0:
    enabled: true
    allowed_sessions: ["EU", "OVERLAP", "US"]
    allowed_vol_regimes: ["LOW", "MEDIUM", "HIGH"]
    
    block_trend_vol_combos:
      - trend: "TREND_NEUTRAL"
        vol: "HIGH"
      - trend: "TREND_DOWN"
        vol: "HIGH"
      - trend: "TREND_UP"
        vol: "LOW"
