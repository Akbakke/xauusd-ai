# GX1 v1.1 → Hybrid exit controller (RULE5 + RULE6A) full-year replay
#
# Entry: FARM_V2B mp68_max5_cd0 (long-only)
# Exit: RULE5 default + hybrid routing (RULE5/RULE6A) per trade
# Window: Full 2025 (2025-01-02 → 2025-12-31) – supply dates via replay CLI

policy_name: GX1_V11_OANDA_DEMO_V9_FARM_V2B_EXIT_HYBRID_FULLYEAR
version: "GX1_V11_OANDA_DEMO_V9_FARM_V2B_EXIT_HYBRID_FULLYEAR"
mode: "REPLAY"
instrument: "XAU_USD"
timeframe: "M5"
warmup_bars: 288

entry_config: gx1/configs/policies/prod_snapshot/2025_FARM_V2B_HYBRID/ENTRY_V9_FARM_V2B_PROD.yaml
exit_config: gx1/configs/exits/FARM_EXIT_V2_RULES_A_mp68_max5_rule5_cd0.yaml

exit_policies:
  rule5: gx1/configs/exits/FARM_EXIT_V2_RULES_A_mp68_max5_rule5_cd0.yaml
  rule6a: gx1/configs/exits/FARM_EXIT_V2_RULES_ADAPTIVE_v1.yaml

exit_hybrid:
  enabled: true
  mode: RULE5_RULE6A_ATR_SPREAD_V1
  atr_low_pct: 0.0
  atr_high_pct: 75.0
  max_spread_pct: 40.0
  allowed_regimes:
    - FARM_ASIA_MEDIUM
  exit_params:
    enable_tp: true
    enable_trailing: true
    enable_be: true

hybrid_exit_router:
  version: HYBRID_ROUTER_V1
  atr_pct_threshold: 0.75   # keep trades below 75th ATR percentile on RULE6A scalper mode
  spread_pct_threshold: 0.40  # require spread percentile ≤40% for RULE6A selection
  allowed_regimes: ["FARM_ASIA_MEDIUM"]
  documentation: |
    2025 Q1-Q4 hybrid results:
      - Routing mix: 88.9% RULE5 / 11.1% RULE6A
      - EV/day ≈ 80.49 bps across full year (Q2 peak ≈ 96.31 bps/day)
      - Win rate: 100%, Max DD: 0 bps

trade_log_csv: gx1/wf_runs/FARM_V2B_EXIT_HYBRID_2025/trade_log.csv

logging:
  level: INFO
  log_dir: gx1/wf_runs/FARM_V2B_EXIT_HYBRID_2025/logs

execution:
  max_open_trades: 5

risk:
  min_time_between_trades_sec: 0
