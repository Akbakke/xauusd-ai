# GX1 v1.1 â†’ Hybrid exit controller V3_RANGE (CANARY mode)
#
# Same as PROD_BASELINE but with mode: CANARY
# Runs full pipeline with dry_run=True, logs all invariants, generates prod_metrics

meta:
  router_version: V3_RANGE
  role: PROD_BASELINE
  frozen_date: 2025-12-15
  description: >
    CANARY mode: Full pipeline test with dry_run=True.
    All invariants are logged and verified.
    Prod metrics are generated at the end.

policy_name: GX1_V11_OANDA_DEMO_V9_FARM_V2B_EXIT_HYBRID_V3_RANGE_CANARY
version: "GX1_V11_OANDA_DEMO_V9_FARM_V2B_EXIT_HYBRID_V3_RANGE_CANARY"
mode: "CANARY"  # Canary mode: dry_run=True, log invariants
instrument: "XAU_USD"
timeframe: "M5"
warmup_bars: 288

entry_config: gx1/configs/policies/prod_snapshot/2025_FARM_V2B_HYBRID/ENTRY_V9_FARM_V2B_PROD.yaml
exit_config: gx1/configs/exits/FARM_EXIT_V2_RULES_A_mp68_max5_rule5_cd0.yaml

exit_policies:
  rule5: gx1/configs/exits/FARM_EXIT_V2_RULES_A_mp68_max5_rule5_cd0.yaml
  rule6a: gx1/configs/exits/FARM_EXIT_V2_RULES_ADAPTIVE_v1.yaml

exit_hybrid:
  enabled: true
  mode: RULE5_RULE6A_ATR_SPREAD_V1
  atr_low_pct: 0.0
  atr_high_pct: 75.0
  max_spread_pct: 40.0
  allowed_regimes:
    - FARM_ASIA_MEDIUM
  exit_params:
    enable_tp: true
    enable_trailing: true
    enable_be: true

hybrid_exit_router:
  version: HYBRID_ROUTER_V3
  v3_range_edge_cutoff: 1.0
  model_path: exit_router_v3_tree.pkl  # Relative to gx1/prod/current/

logging:
  level: INFO
  log_dir: gx1/wf_runs/GX1_V11_OANDA_DEMO_V9_FARM_V2B_EXIT_HYBRID_V3_RANGE_CANARY/logs

execution:
  max_open_trades: 5

risk:
  min_time_between_trades_sec: 0

